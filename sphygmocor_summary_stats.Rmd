---
title: "Sphygmocor Summary Stats"
author: "Ethan Walker"
date: "January 2nd, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


```{r, message=FALSE}
library(tidyverse)
library(magrittr)
library(gridExtra)
library(lubridate)
library(haven)
library(knitr)
```

---

```{r}
#load full dataset
r00_full_joined_sphygmocor <- read_rds("output/r00_full_joined_sphygmocor.RDS")
```

## Variables grouped by study arm
```{r}
summary_hr <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "hr", mean = mean(hr), median = median(hr),
            max = max(hr), min = min(hr))

summary_sys_bp_periph <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "sys bp periph", mean = mean(sys_bp_periph), median = median(sys_bp_periph),
            max = max(sys_bp_periph), min = min(sys_bp_periph))

summary_dia_bp_periph <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "dia bp periph", mean = mean(dia_bp_periph), median = median(dia_bp_periph),
            max = max(dia_bp_periph), min = min(dia_bp_periph))

summary_map_periph <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "map periph", mean = mean(map_periph), median = median(map_periph),
            max = max(map_periph), min = min(map_periph))

summary_sys_bp_central <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "sys bp central", mean = mean(sys_bp_central), median = median(sys_bp_central),
            max = max(sys_bp_central), min = min(sys_bp_central))

summary_dia_bp_central <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "dia bp central", mean = mean(dia_bp_central), median = median(dia_bp_central),
            max = max(dia_bp_central), min = min(dia_bp_central))

summary_map_central <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "map central", mean = mean(map_central), median = median(map_central),
            max = max(map_central), min = min(map_central))

summary_aug_pressure <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "aug pressure", mean = mean(aug_pressure), median = median(aug_pressure),
            max = max(aug_pressure), min = min(aug_pressure))

summary_aug_index <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "aug index", mean = mean(aug_index), median = median(aug_index),
            max = max(aug_index), min = min(aug_index))

summary_aug_index_75 <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "aug index 75", mean = mean(aug_index_75), median = median(aug_index_75),
            max = max(aug_index_75), min = min(aug_index_75))

summary_pulse_pressure_central <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "pulse pressure central", mean = mean(pulse_pressure_central), 
            median = median(pulse_pressure_central),
            max = max(pulse_pressure_central), min = min(pulse_pressure_central))

summary_pulse_pressure_periph <- r00_full_joined_sphygmocor %>% 
  select(study_arm, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(study_arm) %>% 
  summarise(variable = "pulse pressure periph", mean = mean(pulse_pressure_periph), 
            median = median(pulse_pressure_periph),
            max = max(pulse_pressure_periph), min = min(pulse_pressure_periph))

summary <- rbind(summary_hr, summary_sys_bp_periph, summary_dia_bp_periph, 
                 summary_map_periph, summary_pulse_pressure_periph, 
                 summary_sys_bp_central, summary_dia_bp_central, 
                 summary_map_central, summary_pulse_pressure_central, 
                 summary_aug_index, summary_aug_index_75, summary_aug_pressure)
kable(summary, digits = 2)
```

## Variables grouped by phase
```{r}
summary_hr <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "hr", mean = mean(hr), median = median(hr),
            max = max(hr), min = min(hr))

summary_sys_bp_periph <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "sys bp periph", mean = mean(sys_bp_periph), median = median(sys_bp_periph),
            max = max(sys_bp_periph), min = min(sys_bp_periph))

summary_dia_bp_periph <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "dia bp periph", mean = mean(dia_bp_periph), median = median(dia_bp_periph),
            max = max(dia_bp_periph), min = min(dia_bp_periph))

summary_map_periph <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "map periph", mean = mean(map_periph), median = median(map_periph),
            max = max(map_periph), min = min(map_periph))

summary_sys_bp_central <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "sys bp central", mean = mean(sys_bp_central), median = median(sys_bp_central),
            max = max(sys_bp_central), min = min(sys_bp_central))

summary_dia_bp_central <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "dia bp central", mean = mean(dia_bp_central), median = median(dia_bp_central),
            max = max(dia_bp_central), min = min(dia_bp_central))

summary_map_central <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "map central", mean = mean(map_central), median = median(map_central),
            max = max(map_central), min = min(map_central))

summary_aug_pressure <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "aug pressure", mean = mean(aug_pressure), median = median(aug_pressure),
            max = max(aug_pressure), min = min(aug_pressure))

summary_aug_index <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "aug index", mean = mean(aug_index), median = median(aug_index),
            max = max(aug_index), min = min(aug_index))

summary_aug_index_75 <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "aug index 75", mean = mean(aug_index_75), median = median(aug_index_75),
            max = max(aug_index_75), min = min(aug_index_75))

summary_pulse_pressure_central <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "pulse pressure central", mean = mean(pulse_pressure_central), 
            median = median(pulse_pressure_central),
            max = max(pulse_pressure_central), min = min(pulse_pressure_central))

summary_pulse_pressure_periph <- r00_full_joined_sphygmocor %>% 
  select(phase, aug_index, hr, sys_bp_periph, dia_bp_periph, map_periph,
         sys_bp_central, dia_bp_central, map_central, aug_pressure, aug_index_75,
         pulse_pressure_periph, pulse_pressure_central) %>% 
  na.exclude(aug_index) %>% 
  group_by(phase) %>% 
  summarise(variable = "pulse pressure periph", mean = mean(pulse_pressure_periph), 
            median = median(pulse_pressure_periph),
            max = max(pulse_pressure_periph), min = min(pulse_pressure_periph))

summary <- rbind(summary_hr, summary_sys_bp_periph, summary_dia_bp_periph, 
                 summary_map_periph, summary_pulse_pressure_periph, 
                 summary_sys_bp_central, summary_dia_bp_central, 
                 summary_map_central, summary_pulse_pressure_central, 
                 summary_aug_index, summary_aug_index_75, summary_aug_pressure)
kable(summary, digits = 2)
```
