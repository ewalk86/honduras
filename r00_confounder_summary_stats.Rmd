---
title: "R00 Confounders Summary Stats"
author: "Ethan Walker"
date: "January 8, 2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


```{r, message=FALSE}
library(tidyverse)
library(magrittr)
library(gridExtra)
library(lubridate)
library(haven)
library(knitr)
```

---

```{r}
#load full dataset
r00_full_joined_sphygmocor <- read_rds("output/r00_full_joined_sphygmocor.RDS")
```

# Summary Stats grouped by study arm
```{r}
summary_stats <- r00_full_joined_sphygmocor %>% 
  select(study_arm, house_id, phase, age_current, height, weight, bmi, ses_materials,
         beds_new, dds_total) %>% 
  na.exclude(age_current) %>% 
  mutate("Current Age" = as.numeric(age_current), 
         "Height" = as.numeric(height), 
         "Weight" = as.numeric(weight), 
         "Body Mass Index" = as.numeric(bmi), 
         "SES Materials" = as.numeric(ses_materials), 
         "Beds Per Person" = as.numeric(beds_new), 
         "Dietary Diversity Score" = as.numeric(dds_total)) %>% 
  
  ##### need to fix this in the main database #####
  mutate(Height = if_else(phase == 6 & house_id == "CER009", 57.0, Height)) %>% 
  mutate("Body Mass Index" = (Weight*0.453592)/((Height*0.0254)^2)) %>% 

  select(-house_id, -phase, -age_current, -height, -weight, -bmi, -ses_materials,
         -beds_new, -dds_total) %>% 
  group_by(study_arm) %>% 
  summarise_all(funs("_mean" = mean, "_sd" = sd, "_median" = median, 
                     "_min" = min, "_max" = max, "_n" = n())) %>% 
  gather(var, value, -study_arm) %>% 
  separate(var, into = c("var", "stat"), sep = "__") %>% 
  spread(stat, value) %>% 
  arrange(var, study_arm) %>% 
  select(var, study_arm, n, mean, sd, median, max, min) %>% 
  rename("Variable" = var, "Study Arm" = study_arm)
kable(summary_stats, digits = 2)
```

